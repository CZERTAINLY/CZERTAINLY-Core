app:
  version: '@project.version@'

auth-service:
  base-url: http://authservice.dev
opa:
  base-url: http://opa.dev

cmp:
  protocol:
    poll:
      feature:
        timeout: 10
  verbose: true

hibernate:
  types:
    print:
      banner: false

logging:
  level:
    org:
      hibernate: warn
  pattern:
    console: '[%d{yyyy-MM-dd HH:mm:ss.SSS}] %-5level [%t] [%logger - %line]: %m%n'
  schema-version: '@log-schema.version@'

scheduled-tasks:
  enabled: false

scheduler:
  base-url: http://localhost:8080

secrets:
  encryption:
    key: test123

server:
  port: 8082
  servlet:
    context-path: /api
  ssl:
    certificate-header-name: ${HEADER_NAME:X-APP-CERTIFICATE}
    enabled: false

spring:
  datasource:
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    hikari:
      minimum-idle: 5
      maximumPoolSize: 40
      connection-timeout: 10000
      idle-timeout: 30000
      max-lifetime: 60000
    url: jdbc:tc:postgresql:13-alpine://localhost:55432/czertainly-test
    password: test
    username: test
  flyway:
    enabled: false
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        type:
          preferred_duration_jdbc_type: INTERVAL_SECOND
  profiles:
    active: test
  threads:
    virtual:
      enabled: true
  # testcontainers configuration
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
  messaging:
    broker-type: RABBITMQ
    broker-url: amqp://localhost:5672
    user: guest
    password: guest
    session-cache-size: 5
    queue:
      actions: core.actions
      audit-logs: core.audit-logs
      event: core.event
      notification: core.notification
      scheduler: core.scheduler
      validation: core.validation
    exchange: czertainly
    routing-key:
      actions: actions
      audit-logs: audit-logs
      event: event
      notification: notification
      scheduler: scheduler
      validation: validation
    producer:
      retry:
        enabled: true
        initial-interval: 200
        max-attempts: 3
        max-interval: 2000
        multiplier: 2
messaging:
  concurrency:
    actions: 10
    events: 5
    notifications: 3
    scheduler: 10
    validation: 5
    audit-logs: 5

otel:
  instrumentation:
    enabled: false
  sdk:
    disabled: true

settings:
  cache:
    refresh-interval: 30

proxy:
  provisioning:
    api:
      url: http://localhost:8080
      api-key: test-api-key
      connect-timeout: 500
      read-timeout: 1s
      installation-format: helm
      retry:
        max-attempts: 2
        delay: 500
        max-delay: 1000
        multiplier: 2
